<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Bluprinter API Documentation</title>
        <link
            rel="stylesheet"
            type="text/css"
            href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css"
        />
        <style>
            body {
                margin: 0;
                padding: 0;
            }
            .topbar {
                display: none;
            }
        </style>
    </head>
    <body>
        <div id="swagger-ui"></div>

        <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
        <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
        <script>
            window.onload = function () {
                const spec = {
                    openapi: "3.0.0",
                    info: {
                        title: "Bluprinter Product API",
                        description:
                            "API for AI to automatically create products in Bluprinter system",
                        version: "1.0.0",
                        contact: {
                            name: "Bluprinter Support",
                            url: "https://bluprinter.com",
                        },
                    },
                    servers: [
                        {
                            url: "https://bluprinter.com",
                            description: "Production Server",
                        },
                        {
                            url: "http://localhost:8000",
                            description: "Local Development Server",
                        },
                    ],
                    security: [
                        {
                            ApiToken: [],
                        },
                    ],
                    paths: {
                        "/api/products/create": {
                            post: {
                                tags: ["Products"],
                                summary: "Create a new product",
                                description:
                                    "Create a new product with media using URLs.\n\n**How it works:**\n1. Provide image/video URLs in media_urls array\n2. API downloads files from URLs\n3. API uploads files to AWS S3\n4. Product is created with S3 URLs\n\n**Supported formats:** Images (jpg, png, gif, webp), Videos (mp4, avi, mov, webm)",
                                operationId: "createProduct",
                                security: [
                                    {
                                        ApiToken: [],
                                    },
                                ],
                                requestBody: {
                                    required: true,
                                    content: {
                                        "multipart/form-data": {
                                            schema: {
                                                type: "object",
                                                required: [
                                                    "name",
                                                    "template_id",
                                                ],
                                                properties: {
                                                    name: {
                                                        type: "string",
                                                        description:
                                                            "Product name",
                                                        example:
                                                            "AI Generated T-Shirt Design",
                                                    },
                                                    description: {
                                                        type: "string",
                                                        description:
                                                            "Product description (optional, will be copied from template if not provided)",
                                                        example:
                                                            "Beautiful AI-generated design featuring abstract art",
                                                    },
                                                    template_id: {
                                                        type: "integer",
                                                        description:
                                                            "Product template ID (1 for T-Shirt, 2 for Hoodie, etc.)",
                                                        example: 1,
                                                    },
                                                    "media_urls[0]": {
                                                        type: "string",
                                                        format: "uri",
                                                        description:
                                                            "First image/video URL - API will download and upload to S3",
                                                        example: "https://picsum.photos/800/600?random=1",
                                                    },
                                                    "media_urls[1]": {
                                                        type: "string",
                                                        format: "uri",
                                                        description:
                                                            "Second image/video URL (optional)",
                                                        example: "https://picsum.photos/800/600?random=2",
                                                    },
                                                    "media_urls[2]": {
                                                        type: "string",
                                                        format: "uri",
                                                        description:
                                                            "Third image/video URL (optional)",
                                                        example: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4",
                                                    },
                                                    price: {
                                                        type: "number",
                                                        format: "float",
                                                        description:
                                                            "Product price (optional, will use template's base_price if not provided)",
                                                        example: 29.99,
                                                    },
                                                    shop_id: {
                                                        type: "integer",
                                                        description:
                                                            "Shop ID (optional, will use template's shop_id if not provided)",
                                                        example: 1,
                                                    },
                                                    quantity: {
                                                        type: "integer",
                                                        description:
                                                            "Product quantity (optional, default: 999)",
                                                        example: 999,
                                                    },
                                                },
                                            },
                                        },
                                    },
                                },
                                responses: {
                                   201: {
                                       description:
                                           "Product created successfully",
                                       content: {
                                           "application/json": {
                                               schema: {
                                                   type: "object",
                                                   properties: {
                                                       success: {
                                                           type: "boolean",
                                                           example: true,
                                                       },
                                                       message: {
                                                           type: "string",
                                                           example:
                                                               "Product created successfully",
                                                       },
                                                       product_id: {
                                                           type: "integer",
                                                           description:
                                                               "ID of the created product",
                                                           example: 123,
                                                       },
                                                       product_url: {
                                                           type: "string",
                                                           description:
                                                               "URL to view the created product",
                                                           example:
                                                               "https://bluprinter.com/products/ai-generated-t-shirt-design",
                                                       },
                                                   },
                                               },
                                           },
                                       },
                                   },
                                    400: {
                                        description: "Validation error",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                                examples: {
                                                    validation: {
                                                        summary:
                                                            "Validation Error",
                                                        value: {
                                                            success: false,
                                                            message:
                                                                "Validation failed",
                                                            errors: {
                                                                name: [
                                                                    "The name field is required.",
                                                                ],
                                                                images: [
                                                                    "At least one image is required.",
                                                                ],
                                                            },
                                                        },
                                                    },
                                                },
                                            },
                                        },
                                    },
                                    401: {
                                        description: "Authentication failed",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                                examples: {
                                                    missing_token: {
                                                        summary:
                                                            "Missing Token",
                                                        value: {
                                                            success: false,
                                                            message:
                                                                "API token is required",
                                                        },
                                                    },
                                                    invalid_token: {
                                                        summary:
                                                            "Invalid Token",
                                                        value: {
                                                            success: false,
                                                            message:
                                                                "Invalid API token",
                                                        },
                                                    },
                                                },
                                            },
                                        },
                                    },
                                    404: {
                                        description: "Template not found",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                                example: {
                                                    success: false,
                                                    message:
                                                        "Template not found",
                                                },
                                            },
                                        },
                                    },
                                    500: {
                                        description: "Server error",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                                example: {
                                                    success: false,
                                                    message:
                                                        "Failed to upload image to S3",
                                                },
                                            },
                                        },
                                    },
                                },
                            },
                        },
                        "/api/upload/presigned-urls": {
                            post: {
                                tags: ["Upload"],
                                summary: "Get presigned URLs for file upload",
                                description:
                                    "Generate presigned URLs for direct upload to S3. Use these URLs to upload files directly to S3, then use the returned URLs in product creation.",
                                operationId: "getPresignedUrls",
                                security: [
                                    {
                                        ApiToken: [],
                                    },
                                ],
                                requestBody: {
                                    required: true,
                                    content: {
                                        "application/json": {
                                            schema: {
                                                type: "object",
                                                required: ["files"],
                                                properties: {
                                                    files: {
                                                        type: "array",
                                                        items: {
                                                            type: "object",
                                                            required: ["filename", "content_type"],
                                                            properties: {
                                                                filename: {
                                                                    type: "string",
                                                                    description: "Original filename",
                                                                    example: "product-image.jpg",
                                                                },
                                                                content_type: {
                                                                    type: "string",
                                                                    description: "MIME type of the file",
                                                                    example: "image/jpeg",
                                                                },
                                                                file_size: {
                                                                    type: "integer",
                                                                    description: "File size in bytes (optional)",
                                                                    example: 1024000,
                                                                },
                                                            },
                                                        },
                                                        description: "Array of files to upload",
                                                        minItems: 1,
                                                        maxItems: 10,
                                                    },
                                                },
                                            },
                                        },
                                    },
                                },
                                responses: {
                                    200: {
                                        description: "Presigned URLs generated successfully",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        success: {
                                                            type: "boolean",
                                                            example: true,
                                                        },
                                                        data: {
                                                            type: "object",
                                                            properties: {
                                                                upload_urls: {
                                                                    type: "array",
                                                                    items: {
                                                                        type: "object",
                                                                        properties: {
                                                                            filename: {
                                                                                type: "string",
                                                                                example: "product-image.jpg",
                                                                            },
                                                                            upload_url: {
                                                                                type: "string",
                                                                                format: "uri",
                                                                                example: "https://s3.amazonaws.com/bucket/products/1234567890_abc123.jpg?X-Amz-Algorithm=...",
                                                                            },
                                                                            final_url: {
                                                                                type: "string",
                                                                                format: "uri",
                                                                                example: "https://s3.us-east-1.amazonaws.com/image.bluprinter/products/1234567890_abc123.jpg",
                                                                            },
                                                                            expires_in: {
                                                                                type: "integer",
                                                                                description: "URL expiration time in seconds",
                                                                                example: 3600,
                                                                            },
                                                                        },
                                                                    },
                                                                },
                                                            },
                                                        },
                                                    },
                                                },
                                            },
                                        },
                                    },
                                    400: {
                                        description: "Validation error",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                            },
                                        },
                                    },
                                    401: {
                                        description: "Authentication failed",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                            },
                                        },
                                    },
                                },
                            },
                        },
                        "/api/products/{id}": {
                            get: {
                                tags: ["Products"],
                                summary: "Get product details",
                                description:
                                    "Retrieve details of a specific product",
                                operationId: "getProduct",
                                parameters: [
                                    {
                                        name: "id",
                                        in: "path",
                                        required: true,
                                        description: "Product ID",
                                        schema: {
                                            type: "integer",
                                            example: 123,
                                        },
                                    },
                                ],
                                responses: {
                                    200: {
                                        description: "Product details",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        success: {
                                                            type: "boolean",
                                                            example: true,
                                                        },
                                                        data: {
                                                            $ref: "#/components/schemas/Product",
                                                        },
                                                    },
                                                },
                                            },
                                        },
                                    },
                                    404: {
                                        description: "Product not found",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    $ref: "#/components/schemas/Error",
                                                },
                                            },
                                        },
                                    },
                                },
                            },
                        },
                        "/api/products": {
                            get: {
                                tags: ["Products"],
                                summary: "List all products",
                                description:
                                    "Get a paginated list of all products",
                                operationId: "listProducts",
                                parameters: [
                                    {
                                        name: "page",
                                        in: "query",
                                        description: "Page number",
                                        schema: {
                                            type: "integer",
                                            default: 1,
                                            example: 1,
                                        },
                                    },
                                    {
                                        name: "per_page",
                                        in: "query",
                                        description: "Items per page",
                                        schema: {
                                            type: "integer",
                                            default: 15,
                                            example: 15,
                                        },
                                    },
                                ],
                                responses: {
                                    200: {
                                        description: "List of products",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        success: {
                                                            type: "boolean",
                                                            example: true,
                                                        },
                                                        data: {
                                                            type: "array",
                                                            items: {
                                                                $ref: "#/components/schemas/Product",
                                                            },
                                                        },
                                                        pagination: {
                                                            type: "object",
                                                            properties: {
                                                                current_page: {
                                                                    type: "integer",
                                                                    example: 1,
                                                                },
                                                                total: {
                                                                    type: "integer",
                                                                    example: 50,
                                                                },
                                                                per_page: {
                                                                    type: "integer",
                                                                    example: 15,
                                                                },
                                                            },
                                                        },
                                                    },
                                                },
                                            },
                                        },
                                    },
                                },
                            },
                        },
                    },
                    components: {
                        securitySchemes: {
                            ApiToken: {
                                type: "apiKey",
                                in: "header",
                                name: "X-API-Token",
                                description:
                                    "API Token for authentication. Format: `bluprinter_xxxxx...`\n\nĐể lấy token, đăng nhập với tài khoản admin và truy cập: https://bluprinter.com/admin/api-token",
                            },
                        },
                        schemas: {
                            Product: {
                                type: "object",
                                properties: {
                                    id: {
                                        type: "integer",
                                        example: 123,
                                    },
                                    name: {
                                        type: "string",
                                        example: "AI Generated T-Shirt Design",
                                    },
                                    slug: {
                                        type: "string",
                                        example: "ai-generated-t-shirt-design",
                                    },
                                    description: {
                                        type: "string",
                                        example:
                                            "Beautiful AI-generated design",
                                    },
                                    price: {
                                        type: "number",
                                        format: "float",
                                        example: 29.99,
                                    },
                                    template_id: {
                                        type: "integer",
                                        example: 1,
                                    },
                                    shop_id: {
                                        type: "integer",
                                        example: 1,
                                    },
                                    status: {
                                        type: "string",
                                        enum: ["active", "inactive"],
                                        example: "active",
                                    },
                                    media: {
                                        type: "array",
                                        items: {
                                            type: "string",
                                        },
                                        example: [
                                            "https://s3.amazonaws.com/bucket/products/image1.jpg",
                                            "https://s3.amazonaws.com/bucket/products/video.mp4",
                                        ],
                                    },
                                    created_by: {
                                        type: "string",
                                        example: "api",
                                    },
                                    created_at: {
                                        type: "string",
                                        format: "date-time",
                                        example: "2025-10-16T10:30:00.000000Z",
                                    },
                                    updated_at: {
                                        type: "string",
                                        format: "date-time",
                                        example: "2025-10-16T10:30:00.000000Z",
                                    },
                                },
                            },
                            Error: {
                                type: "object",
                                properties: {
                                    success: {
                                        type: "boolean",
                                        example: false,
                                    },
                                    message: {
                                        type: "string",
                                        example: "Error message",
                                    },
                                    errors: {
                                        type: "object",
                                        additionalProperties: {
                                            type: "array",
                                            items: {
                                                type: "string",
                                            },
                                        },
                                    },
                                },
                            },
                        },
                    },
                    tags: [
                        {
                            name: "Products",
                            description: "Product management endpoints",
                        },
                        {
                            name: "Upload",
                            description: "File upload and presigned URL endpoints",
                        },
                    ],
                };

                SwaggerUIBundle({
                    spec: spec,
                    dom_id: "#swagger-ui",
                    deepLinking: true,
                    presets: [
                        SwaggerUIBundle.presets.apis,
                        SwaggerUIStandalonePreset,
                    ],
                    plugins: [SwaggerUIBundle.plugins.DownloadUrl],
                    layout: "StandaloneLayout",
                });
            };
        </script>
    </body>
</html>
